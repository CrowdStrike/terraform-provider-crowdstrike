---
page_title: "crowdstrike_cloud_posture_custom_rule Resource - crowdstrike"
subcategory: "Cloud Posture"
description: |-
  This resource manages custom cloud posture rules. These rules can be created either by inheriting properties from a parent rule with minimal customization, or by fully customizing all attributes for maximum flexibility.
  API Scopes
  The following API scopes are required:
  Cloud Security Policies | Read & Write
---

# crowdstrike_cloud_posture_custom_rule (Resource)

This resource manages custom cloud posture rules. These rules can be created either by inheriting properties from a parent rule with minimal customization, or by fully customizing all attributes for maximum flexibility.

## API Scopes

The following API scopes are required:

- Cloud Security Policies | Read & Write


## Example Usage

```terraform
terraform {
  required_providers {
    crowdstrike = {
      source = "registry.terraform.io/crowdstrike/crowdstrike"
    }
  }
}

provider "crowdstrike" {
  cloud = "us-2"
}

# Custom rule derived from a parent rule with specific modifications
resource "crowdstrike_cloud_posture_custom_rule" "copy_rule" {
  resource_type    = "AWS::EC2::Instance"
  subdomain        = "IOM"
  name             = "Test Terraform"
  description      = "Test Terraform"
  cloud_platform   = "AWS"
  cloud_provider   = "AWS"
  severity         = 1
  remediation_info = <<-EOT
    Step 1. Remediation step 1.|
    Step 2. Remediation step 2.|
    Step 3. Remediation step 3.
EOT
  alert_info = [
    "First item in alert info",
    "Second item in alert info"
  ]
  controls = [
    {
      authority = "CIS",
      code      = "89"
    },
    {
      authority = "CIS",
      code      = "791"
    }
  ]
  parent_rule_id = "190c2d3d-8b0e-4838-bf11-4c6e044b9cb1"
}

resource "crowdstrike_cloud_posture_custom_rule" "custom_rule" {
  resource_type  = "AWS::EC2::Instance"
  subdomain      = "IOM"
  name           = "Test Terraform"
  description    = "Test Terraform"
  cloud_platform = "AWS"
  cloud_provider = "AWS"
  attack_types = [
    "this is an attack type"
  ]
  remediation_info = <<-EOT
    Step 1. Remediation step 1.|
    Step 2. Remediation step 2.|
    Step 3. Remediation step 3.
EOT
  severity         = 2
  logic            = <<EOF
package crowdstrike
default result = "pass"
result = "fail" if {
  input.tags[_] == "catch-me"
}
EOF
  alert_info = [
    "First item in alert info",
    "Second item in alert info"
  ]
  controls = [
    {
      authority = "CIS",
      code      = "89"
    },
    {
      authority = "CIS",
      code      = "791"
    },
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cloud_platform` (String) Cloud platform for the policy rule.
- `cloud_provider` (String) Cloud provider for the policy rule.
- `description` (String) Description of the policy rule.
- `name` (String) Name of the policy rule.
- `resource_type` (String) The full resource type. Format examples: AWS: AWS::IAM::CredentialReport, Azure: Microsoft.Compute/virtualMachines, GCP: container.googleapis.com/Cluster.
- `subdomain` (String) Subdomain for the policy rule. Valid values are 'IOM' (Indicators of Misconfiguration) or 'IaC' (Indicators of Attack). IOM is only supported at this time.

### Optional

- `alert_info` (List of String) A list of the alert logic and detection criteria for rule violations. Parent value will be used when parent_rule_id is defined.
- `attack_types` (Set of String) Specific attack types associated with the rule. Note: If 'parent_rule_id' is specified, these attack types will be inherited from the parent rule, and any values provided here will be ignored.
- `controls` (Attributes Set) Security framework and compliance rule information. (see [below for nested schema](#nestedatt--controls))
- `logic` (String) Rego logic for the rule. If this is not defined, then parent_rule_id must be defined.
- `parent_rule_id` (String) UUID of the parent rule to inherit properties from. Required if logic is not specified.
- `remediation_info` (String) Information about how to remediate issues detected by this rule.
- `severity` (Number) Severity of the rule. Valid values are 0 (critical), 1 (high), 2 (medium), 3 (informational).

### Read-Only

- `domain` (String) CrowdStrike domain for the custom rule. Default is CSPM
- `uuid` (String) Unique identifier of the policy rule.

<a id="nestedatt--controls"></a>
### Nested Schema for `controls`

Required:

- `authority` (String) This compliance framework
- `code` (String) The compliance framework rule code

## Import

Import is supported using the following syntax:

```shell
# Cloud Posture Custom Rule resources can be imported using their UUID, e.g.
terraform import crowdstrike_cloud_posture_custom_rule.example 123e4567-e89b-12d3-a456-426614174000
```
